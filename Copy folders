Sub CopyFoldersBasedOnExcelList()
    Dim objFSO As Object
    Dim ws As Worksheet
    Dim sourcePath As String
    Dim targetPath As String
    Dim folderName As String
    Dim lastRow As Long
    Dim i As Long
    
    ' Initialize FileSystemObject
    Set objFSO = CreateObject("Scripting.FileSystemObject")
    
    ' Set the worksheet where folder names are listed
    Set ws = ThisWorkbook.Sheets(1)
    
    ' Prompt user to select the source directory
    With Application.FileDialog(msoFileDialogFolderPicker)
        .Title = "Select Source Folder"
        .AllowMultiSelect = False
        If .Show = -1 Then
            sourcePath = .SelectedItems(1)
        Else
            MsgBox "No source folder selected. Exiting..."
            Exit Sub
        End If
    End With
    
    ' Prompt user to select the target directory
    With Application.FileDialog(msoFileDialogFolderPicker)
        .Title = "Select Target Folder"
        .AllowMultiSelect = False
        If .Show = -1 Then
            targetPath = .SelectedItems(1)
        Else
            MsgBox "No target folder selected. Exiting..."
            Exit Sub
        End If
    End With
    
    ' Get the last row with data in column A (assuming folder names are in column A)
    lastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row
    
    ' Loop through the folder names in column A
    For i = 1 To lastRow
        folderName = ws.Cells(i, 1).Value
        
        ' Check if the folder exists in the source directory
        If objFSO.FolderExists(sourcePath & "\" & folderName) Then
            ' Copy the folder to the target directory
            objFSO.CopyFolder sourcePath & "\" & folderName, targetPath & "\" & folderName
            ws.Cells(i, 2).Value = "Copied" ' Mark as copied in column B
        Else
            ws.Cells(i, 2).Value = "Not Found" ' Mark as not found in column B
        End If
    Next i
    
    ' Clean up
    Set objFSO = Nothing
    
    MsgBox "Folder copy process completed. Check column B for status."
End Sub
